<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>聊天</title>
    
    <!-- CSS文件引入 -->
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/chat/chat-common.css">
    <link rel="stylesheet" href="css/chat/chat-list.css">
    <link rel="stylesheet" href="css/chat/friend-list.css">
    <link rel="stylesheet" href="css/chat/discover.css">
    <link rel="stylesheet" href="css/chat/profile.css">
</head>
<body>
    
    <!-- 聊天APP容器 -->
    <div class="chat-app-container">
        
        <!-- 顶部导航栏 -->
<div class="top-bar">
    <button class="back-btn" id="backBtn">
        <img src="assets/icons/chat/back.png" alt="返回">
    </button>
    <h1 class="page-title" id="pageTitle">聊天</h1>
    <div class="top-right-btns" id="topRightBtns">
        <!-- 聊天列表的按钮（默认显示） -->
        <button class="search-btn page-btn chat-list-btn" id="searchChatBtn" title="搜索聊天记录">
            <img src="assets/icons/chat/search-chat.png" alt="搜索">
        </button>
        <button class="add-chat-btn page-btn chat-list-btn" id="addChatBtn" title="创建聊天框">
            <img src="assets/icons/chat/add-chat.png" alt="创建聊天">
        </button>
        
        <!-- 好友列表的按钮（默认隐藏） -->
        <button class="manage-group-btn page-btn friend-list-btn" id="manageGroupBtn" title="管理分组" style="display: none;">
            <img src="assets/icons/chat/manage-group.png" alt="管理分组">
        </button>
        <button class="add-friend-btn page-btn friend-list-btn" id="addFriendBtn" title="添加好友" style="display: none;">
            <img src="assets/icons/chat/add-friend.png" alt="添加好友">
        </button>
    </div>
</div>

<!-- 页面容器 -->
<div class="pages-container">
    
    <!-- 聊天列表页 -->
    <div class="chat-page active" id="chatListPage">
        <div class="page-content">
            <div class="empty-placeholder">
                <div class="empty-icon">💬</div>
                <div class="empty-text">暂无聊天</div>
            </div>
        </div>
    </div>
    
    <!-- 好友列表页 -->
<div class="chat-page" id="friendListPage">
    <div class="page-content friend-list-content">
        
        <!-- 好友分组列表 -->
        <div class="friend-groups" id="friendGroups">
            
            <!-- 默认分组 -->
            <div class="friend-group">
                <div class="group-header" onclick="toggleGroup(this)">
                    <span class="group-arrow">▶</span>
                    <span class="group-name">我的好友</span>
                    <span class="group-count">(0)</span>
                </div>
                <div class="group-members">
                    <!-- 好友列表会动态插入这里 -->
                    <div class="empty-group">暂无好友</div>
                </div>
            </div>
            
        </div>
        
    </div>
</div>
    
    <!-- 发现页 -->
    <div class="chat-page" id="discoverPage">
        <div class="page-content">
            <div class="empty-placeholder">
                <div class="empty-icon">🔍</div>
                <div class="empty-text">发现更多</div>
            </div>
        </div>
    </div>
    
    <!-- 个人设置页 -->
    <div class="chat-page" id="profilePage">
        <div class="page-content">
            <div class="empty-placeholder">
                <div class="empty-icon">⚙️</div>
                <div class="empty-text">个人设置</div>
            </div>
        </div>
    </div>
    
</div>

<!-- 添加好友页面 -->
<div class="sub-page" id="addFriendPage">
    <div class="top-bar">
        <button class="back-btn" onclick="closeAddFriend()">
            <img src="assets/icons/chat/back.png" alt="返回">
        </button>
        <h1 class="page-title">添加好友</h1>
        <div class="top-right-btns"></div>
    </div>
    
    <div class="page-content">
        <!-- 添加方式选择 -->
        <div class="add-method-cards">
            
            <!-- 通过编码添加 -->
            <div class="method-card" onclick="showAddByCode()">
                <div class="method-icon">🔢</div>
                <div class="method-info">
                    <div class="method-title">通过编码添加</div>
                    <div class="method-desc">输入好友编码，恢复已有角色</div>
                </div>
                <div class="method-arrow">→</div>
            </div>
            
            <!-- 自定义人设 -->
            <div class="method-card" onclick="showCustomPersona()">
                <div class="method-icon">✨</div>
                <div class="method-info">
                    <div class="method-title">自定义人设</div>
                    <div class="method-desc">创建新角色，自动生成编码</div>
                </div>
                <div class="method-arrow">→</div>
            </div>
            
        </div>
    </div>
</div>

<!-- 人设编辑页面 -->
<div class="sub-page" id="friendProfilePage">
    <div class="top-bar">
        <button class="back-btn" onclick="closeFriendProfile()">
            <img src="assets/icons/chat/back.png" alt="返回">
        </button>
        <h1 class="page-title">好友资料</h1>
        <div class="top-right-btns">
            <button class="edit-btn" id="editProfileBtn" onclick="toggleEdit()">
                编辑
            </button>
        </div>
    </div>
    
    <div class="page-content profile-content">
        
        <!-- 头像区域 -->
        <div class="profile-avatar-section">
            <div class="profile-avatar" id="profileAvatar">
                <img src="" alt="头像" id="profileAvatarImg">
            </div>
            <div class="avatar-switch-row">
                <span class="switch-label">头像识别</span>
                <label class="switch">
                    <input type="checkbox" id="avatarRecognitionSwitch" disabled>
                    <span class="slider"></span>
                </label>
            </div>
        </div>
        
        <!-- 信息区域 -->
        <div class="profile-info-section">
            
            <!-- 好友编码 -->
            <div class="profile-row">
                <label class="profile-label">好友编码</label>
                <div class="profile-value code-value" id="profileCode" onclick="copyCode()">
                    <span id="codeText">AI123456789</span>
                    <span class="copy-icon">📋</span>
                </div>
            </div>
            
            <!-- 网名 -->
            <div class="profile-row">
                <label class="profile-label">网名</label>
                <input type="text" class="profile-input" id="profileNickname" disabled>
            </div>
            
            <!-- 备注 -->
            <div class="profile-row">
                <label class="profile-label">备注</label>
                <input type="text" class="profile-input" id="profileRemark" placeholder="未设置" disabled>
            </div>
            
            <!-- 真实姓名 -->
            <div class="profile-row">
                <label class="profile-label">真实姓名</label>
                <input type="text" class="profile-input" id="profileRealName" placeholder="未设置" disabled>
            </div>
            
            <!-- 个性签名 -->
            <div class="profile-row">
                <label class="profile-label">个性签名</label>
                <input type="text" class="profile-input" id="profileSignature" placeholder="未设置" disabled>
            </div>
            
            <!-- 拍一拍 -->
            <div class="profile-row">
                <label class="profile-label">拍一拍</label>
                <input type="text" class="profile-input" id="profilePoke" placeholder="拍了拍" disabled>
            </div>
            
            <!-- 人设 -->
            <div class="profile-row full">
                <label class="profile-label">人设</label>
                <textarea class="profile-textarea" id="profilePersona" rows="8" disabled></textarea>
            </div>
            
            <!-- 分组 -->
            <div class="profile-row">
                <label class="profile-label">分组</label>
                <select class="profile-select" id="profileGroup" disabled>
                    <option value="我的好友">我的好友</option>
                </select>
            </div>
            
        </div>
        
        <!-- 危险操作 -->
        <div class="danger-section">
            <button class="danger-btn" onclick="deleteFriend()">
                删除好友
            </button>
        </div>
        
    </div>
</div>

<!-- 通过编码添加页面 -->
<div class="sub-page" id="addByCodePage">
    <div class="top-bar">
        <button class="back-btn" onclick="backToAddFriend()">
            <img src="assets/icons/chat/back.png" alt="返回">
        </button>
        <h1 class="page-title">通过编码添加</h1>
        <div class="top-right-btns"></div>
    </div>
    
    <div class="page-content">
        <div class="input-section">
            <label class="input-label">好友编码</label>
            <input type="text" 
                   class="text-input" 
                   id="friendCodeInput" 
                   placeholder="请输入好友编码">
            <div class="input-hint">格式：AI开头 + 数字和字母</div>
        </div>
        
        <button class="primary-btn" onclick="addFriendByCode()">
            添加好友
        </button>
    </div>
</div>

<!-- 自定义人设页面 -->
<div class="sub-page" id="customPersonaPage">
    <div class="top-bar">
        <button class="back-btn" onclick="backToAddFriend()">
            <img src="assets/icons/chat/back.png" alt="返回">
        </button>
        <h1 class="page-title">自定义人设</h1>
        <div class="top-right-btns"></div>
    </div>
    
    <div class="page-content">
        
        <!-- 头像 -->
        <div class="avatar-section">
            <div class="avatar-upload" id="avatarPreview" onclick="selectAvatar()">
                <span class="avatar-placeholder">📷</span>
                <span class="avatar-hint">点击上传头像</span>
            </div>
        </div>
        
        <!-- 基本信息 -->
        <div class="input-section">
            <label class="input-label">网名 *</label>
            <input type="text" 
                   class="text-input" 
                   id="nicknameInput" 
                   placeholder="给TA起个名字"
                   maxlength="20">
        </div>
        
        <div class="input-section">
            <label class="input-label">个性签名</label>
            <input type="text" 
                   class="text-input" 
                   id="signatureInput" 
                   placeholder="一句话介绍（选填）"
                   maxlength="50">
        </div>
        
        <!-- 人设 -->
        <div class="input-section">
            <label class="input-label">人设 *</label>
            <textarea class="text-area" 
                      id="personaInput" 
                      placeholder="描述角色的性格、背景、说话方式等..."
                      rows="8"></textarea>
            <div class="input-hint">至少20个字</div>
        </div>
        
        <!-- 分组 -->
        <div class="input-section">
            <label class="input-label">分组</label>
            <select class="select-input" id="groupInput">
                <option value="我的好友">我的好友</option>
            </select>
        </div>
        
        <button class="primary-btn" onclick="createCustomFriend()">
            创建好友
        </button>
        
    </div>
</div>

<!-- 底部导航栏 -->
<div class="bottom-nav">
    <button class="nav-btn active" data-page="chatListPage">
        <img src="assets/icons/chat/nav-chat.png" alt="聊天" class="nav-icon-img">
        <div class="nav-label">聊天</div>
    </button>
    <button class="nav-btn" data-page="friendListPage">
        <img src="assets/icons/chat/nav-friend.png" alt="好友" class="nav-icon-img">
        <div class="nav-label">好友</div>
    </button>
    <button class="nav-btn" data-page="discoverPage">
        <img src="assets/icons/chat/nav-discover.png" alt="发现" class="nav-icon-img">
        <div class="nav-label">发现</div>
    </button>
    <button class="nav-btn" data-page="profilePage">
        <img src="assets/icons/chat/nav-profile.png" alt="我" class="nav-icon-img">
        <div class="nav-label">我</div>
    </button>
</div>
        
    </div>
    
    <!-- JavaScript文件引入 -->
    <script src="js/chat/chat-app.js"></script>
    
</body>
</html>
